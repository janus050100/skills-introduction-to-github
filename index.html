<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½é »éŸ³æ³¢ç”¢ç”Ÿç¨‹å¼</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(to right, #6a11cb, #2575fc); /* æ¼¸å±¤èƒŒæ™¯ */
            color: white; /* æ–‡å­—é¡è‰² */
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: rgba(255, 255, 255, 0.1); /* è¡¨æ ¼èƒŒæ™¯é€æ˜ */
            border-radius: 8px; /* åœ“è§’ */
        }
        th, td {
            border: 1px solid rgba(255, 255, 255, 0.3); /* è¡¨æ ¼é‚Šæ¡†é¡è‰² */
            padding: 12px;
            text-align: center;
        }
        th {
            background-color: rgba(255, 255, 255, 0.2); /* è¡¨é ­èƒŒæ™¯é€æ˜ */
            color: #00FF00; /* æ›´äº®çš„ç¶ è‰² */
        }
        .description {
            margin: 20px 0;
            font-size: 1.1em;
            background-color: rgba(255, 255, 255, 0.2); /* æè¿°èƒŒæ™¯é€æ˜ */
            padding: 10px;
            border-radius: 5px; /* åœ“è§’ */
        }
        .slider-container {
            text-align: center;
            margin: 20px 0;
        }
        .frequency-display {
            font-size: 1.5em;
            text-align: center;
            margin: 10px 0;
            color: #FFD700; /* é‡‘è‰² */
        }
        .button-container {
            text-align: center;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
            margin: 0 10px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #4CAF50; /* æŒ‰éˆ•é¡è‰² */
            color: white;
            width: 100%; /* ä½¿æŒ‰éˆ•åœ¨å°è¢å¹•ä¸Šå…¨å¯¬ */
        }
        button:hover {
            background-color: #45a049; /* æŒ‰éˆ•æ‡¸åœé¡è‰² */
        }
        .progress-container {
            width: 100%;
            height: 20px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-bar {
            height: 100%;
            width: 0;
            background-color: #FFD700; /* é‡‘è‰² */
            transition: width 0.1s linear;
        }
        .timer-display {
            font-size: 1.5em;
            text-align: center;
            margin: 10px 0;
            color: #FFD700; /* é‡‘è‰² */
        }
        .canvas-container {
            text-align: center;
            margin: 20px 0;
        }
        canvas {
            width: 100%;
            height: 200px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }

        /* åª’é«”æŸ¥è©¢ä»¥é©é…å°è¢å¹• */
        @media (max-width: 600px) {
            button {
                font-size: 0.9em; /* èª¿æ•´æŒ‰éˆ•å­—é«”å¤§å° */
            }
            .description {
                font-size: 1em; /* èª¿æ•´æè¿°å­—é«”å¤§å° */
            }
            .frequency-display {
                font-size: 1.2em; /* èª¿æ•´é »ç‡é¡¯ç¤ºå­—é«”å¤§å° */
            }
        }
    </style>
</head>
<body>

<h1>ä½é »éŸ³æ³¢ç”¢ç”Ÿç¨‹å¼</h1>

<div class="description">
    ğŸ”¸ ä¸»è¦å½±éŸ¿ï¼šå½±éŸ¿ç´°èƒè†œé›»ä½èˆ‡é›¢å­é€šé“ï¼Œå¢å¼·è¡€æ¶²å¾ªç’°èˆ‡ç´°èƒä¿®å¾©èƒ½åŠ›
</div>

<table>
    <tr>
        <th>é »ç‡ç¯„åœ</th>
        <th>å½±éŸ¿</th>
        <th>å¯èƒ½æ‡‰ç”¨</th>
    </tr>
    <tr>
        <td>0.5 - 3 Hz</td>
        <td>å½±éŸ¿è…¦æ³¢ã€æ¸›å°‘ç„¦æ…®</td>
        <td>å†¥æƒ³ã€æ·±å±¤æ”¾é¬†</td>
    </tr>
    <tr>
        <td>4 - 7 Hzï¼ˆTheta æ³¢ï¼‰</td>
        <td>åˆºæ¿€ç¥ç¶“ç³»çµ±ã€ä¿®å¾©ç´°èƒ</td>
        <td>ç¡çœ æ²»ç™‚ã€ç´°èƒä¿®å¾©</td>
    </tr>
    <tr>
        <td>8 - 14 Hzï¼ˆAlpha æ³¢ï¼‰</td>
        <td>å¢å¼·ç´°èƒèƒ½é‡ä»£è¬</td>
        <td>æé«˜å°ˆæ³¨åŠ›ã€æ¸›å°‘å£“åŠ›</td>
    </tr>
    <tr>
        <td>15 - 20 Hz</td>
        <td>ä¿ƒé€²è¡€æ¶²å¾ªç’°ã€åŠ é€Ÿç´°èƒä¿®å¾©</td>
        <td>ç–¼ç—›ç®¡ç†ã€ç¥ç¶“åº·å¾©</td>
    </tr>
</table>

<div class="description">
    âœ… ç´°èƒæ©Ÿåˆ¶ï¼š<br>
    â€¢ ä½é »éŸ³æ³¢å¯ä»¥å½±éŸ¿ç´°èƒè†œçš„é›»è·åˆ†å¸ƒï¼Œé€²è€Œå½±éŸ¿é›»ä½å·®<br>
    â€¢ å°é›¢å­é€šé“ï¼ˆéˆ£ã€éˆ‰ã€é‰€ï¼‰ç”¢ç”Ÿä½œç”¨ï¼Œå½±éŸ¿ç´°èƒå…§å¤–é›»æµå‚³å°
</div>

<div class="description">
    âœ… æ‡‰ç”¨å ´æ™¯ï¼š<br>
    â€¢ é€éä½é »å…±æŒ¯éŸ³æ³¢ï¼Œå¯ç”¨æ–¼ç´°èƒä¿®å¾©ã€ç–¼ç—›ç®¡ç†èˆ‡ç¥ç¶“åº·å¾©<br>
</div>

<div class="description">
    âœ… æ·»åŠ é è¨­æ¨¡å¼ï¼š<br>
    â€¢ æä¾›ä¸€äº›é è¨­æ¨¡å¼ï¼ˆå¦‚ã€Œæ”¾é¬†æ¨¡å¼ï¼ˆTheta æ³¢ï¼‰ã€ã€ã€Œå°ˆæ³¨æ¨¡å¼ï¼ˆAlpha æ³¢ï¼‰ã€ç­‰ï¼‰ï¼Œç”¨æˆ¶å¯ä»¥å¿«é€Ÿé¸æ“‡é€™äº›æ¨¡å¼ä¾†è¨­å®šæ¨è–¦é »ç‡ã€‚
</div>

<!-- é »ç‡èª¿æ•´ -->
<div class="slider-container">
    <label for="frequencySlider">èª¿æ•´é »ç‡ (0.1 Hz - 20 Hz): </label>
    <input type="range" id="frequencySlider" min="0.1" max="20" step="0.1" value="0.1">
</div>

<div class="frequency-display" id="frequencyDisplay">è¨­å®šé »ç‡: 0.1 Hz</div>

<!-- æ³¢å½¢é¸æ“‡ -->
<div class="slider-container">
    <label for="waveformSelect">é¸æ“‡æ³¢å½¢: </label>
    <select id="waveformSelect">
        <option value="sine">æ­£å¼¦æ³¢</option>
        <option value="square">æ–¹æ³¢</option>
        <option value="triangle">ä¸‰è§’æ³¢</option>
        <option value="sawtooth">é‹¸é½’æ³¢</option>
    </select>
</div>

<!-- æ’­æ”¾æ™‚é–“è¼¸å…¥ -->
<div class="slider-container">
    <label for="durationInput">æ’­æ”¾æ™‚é–“ (ç§’): </label>
    <input type="number" id="durationInput" value="5" min="1">
</div>

<div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
</div>

<div class="timer-display" id="timerDisplay">è¨ˆæ™‚: 0ç§’</div>

<div class="description">
    âœ… éŸ³é‡æ§åˆ¶ï¼š<br>
    <label for="volumeSlider">èª¿æ•´éŸ³é‡: </label>
    <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1">
</div>

<div class="description">
    âœ… ç«‹é«”è²æ¨¡å¼ï¼š<br>
    <label for="leftFrequencySlider">å·¦è€³é »ç‡: </label>
    <input type="range" id="leftFrequencySlider" min="0.1" max="20" step="0.1" value="0.1">
    <label for="rightFrequencySlider">å³è€³é »ç‡: </label>
    <input type="range" id="rightFrequencySlider" min="0.1" max="20" step="0.1" value="0.1">
</div>

<div class="button-container">
    <button id="playButton">æ’­æ”¾</button>
    <button id="stopButton">åœæ­¢</button>
</div>

<!-- éœ‡ç›ªåœ–é¡¯ç¤º -->
<div class="canvas-container">
    <canvas id="oscilloscope"></canvas>
</div>

<script>
    let frequency = 0.1;  // åˆå§‹é »ç‡
    let duration = 5;  // æ’­æ”¾æŒçºŒæ™‚é–“ï¼ˆç§’ï¼‰
    let isPlaying = false; // æ’­æ”¾ç‹€æ…‹
    let progressInterval; // é€²åº¦æ¢è¨ˆæ™‚å™¨
    let timerInterval; // è¨ˆæ™‚å™¨è¨ˆæ™‚å™¨
    let elapsedTime = 0; // è¨ˆæ™‚å™¨æ™‚é–“
    let audioContext;
    let leftOscillator, rightOscillator;
    let gainNode, analyserNode;

    function createAudioContext() {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        gainNode = audioContext.createGain();
        gainNode.gain.value = 1; // åˆå§‹éŸ³é‡
        gainNode.connect(audioContext.destination);

        analyserNode = audioContext.createAnalyser();
        gainNode.connect(analyserNode);
        analyserNode.connect(audioContext.destination);
    }

    function playWave(frequencyLeft, frequencyRight) {
        if (!audioContext) {
            createAudioContext();
        }

        if (leftOscillator) {
            leftOscillator.stop();
            leftOscillator.disconnect();
        }
        if (rightOscillator) {
            rightOscillator.stop();
            rightOscillator.disconnect();
        }

        leftOscillator = audioContext.createOscillator();
        leftOscillator.type = document.getElementById('waveformSelect').value;
        leftOscillator.frequency.setValueAtTime(frequencyLeft, audioContext.currentTime);
        leftOscillator.connect(gainNode);
        leftOscillator.start();

        rightOscillator = audioContext.createOscillator();
        rightOscillator.type = document.getElementById('waveformSelect').value;
        rightOscillator.frequency.setValueAtTime(frequencyRight, audioContext.currentTime);
        rightOscillator.connect(gainNode);
        rightOscillator.start();

        drawOscilloscope(); // é–‹å§‹ç¹ªè£½éœ‡ç›ªåœ–
    }

    function stopWave() {
        if (leftOscillator) {
            leftOscillator.stop();
            leftOscillator.disconnect();
            leftOscillator = null;
        }
        if (rightOscillator) {
            rightOscillator.stop();
            rightOscillator.disconnect();
            rightOscillator = null;
        }
        isPlaying = false;
    }

    function startProgressBar() {
        const progressBar = document.getElementById('progressBar');
        progressBar.style.width = '0%'; // é‡ç½®é€²åº¦æ¢
        let startTime = Date.now();

        progressInterval = setInterval(() => {
            let elapsed = (Date.now() - startTime) / 1000;
            let progress = (elapsed / duration) * 100;

            if (progress >= 100) {
                clearInterval(progressInterval);
                stopWave();  // è‡ªå‹•åœæ­¢éŸ³æ³¢
            } else {
                progressBar.style.width = progress + '%';
            }
        }, 100);
    }

    function stopProgressBar() {
        clearInterval(progressInterval);
        const progressBar = document.getElementById('progressBar');
        progressBar.style.width = '0%'; // é‡ç½®é€²åº¦æ¢
    }

    function startTimer() {
        elapsedTime = 0; // é‡ç½®è¨ˆæ™‚å™¨
        document.getElementById('timerDisplay').innerText = `è¨ˆæ™‚: ${elapsedTime}ç§’`;

        timerInterval = setInterval(() => {
            elapsedTime++;
            document.getElementById('timerDisplay').innerText = `è¨ˆæ™‚: ${elapsedTime}ç§’`;
        }, 1000); // æ¯ç§’æ›´æ–°
    }

    function stopTimer() {
        clearInterval(timerInterval);
        document.getElementById('timerDisplay').innerText = `è¨ˆæ™‚: 0ç§’`; // é‡ç½®è¨ˆæ™‚å™¨é¡¯ç¤º
    }

    function drawOscilloscope() {
        const canvas = document.getElementById('oscilloscope');
        const ctx = canvas.getContext('2d');
        const bufferLength = analyserNode.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);

        function draw() {
            requestAnimationFrame(draw);
            analyserNode.getByteTimeDomainData(dataArray);
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.lineWidth = 2;
            ctx.strokeStyle = '#FFD700';
            ctx.beginPath();

            const sliceWidth = canvas.width / bufferLength;
            let x = 0;

            for (let i = 0; i < bufferLength; i++) {
                const v = dataArray[i] / 128.0; // å°‡æ•¸æ“šæ¨™æº–åŒ–åˆ° 0-1
                const y = v * canvas.height / 2; // å°‡æ•¸æ“šè½‰æ›ç‚ºç•«å¸ƒçš„é«˜åº¦
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                x += sliceWidth;
            }
            ctx.lineTo(canvas.width, canvas.height / 2);
            ctx.stroke();
        }

        draw();
    }

    // ç›£è½æ»‘å‹•æŒ‰éˆ•çš„è®ŠåŒ–
    document.getElementById('frequencySlider').addEventListener('input', function() {
        frequency = parseFloat(this.value);
        document.getElementById('frequencyDisplay').innerText = `è¨­å®šé »ç‡: ${frequency.toFixed(1)} Hz`; // æ›´æ–°é¡¯ç¤ºï¼Œä¿ç•™ä¸€ä½å°æ•¸

        // å³æ™‚æ›´æ–°é »ç‡
        if (isPlaying) {
            leftOscillator.frequency.linearRampToValueAtTime(frequency, audioContext.currentTime + 0.1);
            rightOscillator.frequency.linearRampToValueAtTime(frequency, audioContext.currentTime + 0.1);
        }
    });

    // æ’­æ”¾æŒ‰éˆ•äº‹ä»¶
    document.getElementById('playButton').addEventListener('click', function() {
        duration = parseInt(document.getElementById('durationInput').value); // æ›´æ–°æ’­æ”¾æ™‚é–“
        stopWave();  // å…ˆåœæ­¢ç•¶å‰éŸ³æ³¢ï¼Œç¢ºä¿èƒ½é †åˆ©é‡æ–°æ’­æ”¾
        const leftFrequency = parseFloat(document.getElementById('leftFrequencySlider').value);
        const rightFrequency = parseFloat(document.getElementById('rightFrequencySlider').value);
        playWave(leftFrequency, rightFrequency); // æ’­æ”¾æ–°çš„é »ç‡
        startProgressBar(); // é–‹å§‹é€²åº¦æ¢
        startTimer(); // é–‹å§‹è¨ˆæ™‚å™¨
        isPlaying = true; // è¨­ç½®æ’­æ”¾ç‹€æ…‹
    });

    // åœæ­¢æŒ‰éˆ•äº‹ä»¶
    document.getElementById('stopButton').addEventListener('click', function() {
        stopWave(); // åœæ­¢æ’­æ”¾
        stopProgressBar(); // åœæ­¢é€²åº¦æ¢
        stopTimer(); // åœæ­¢è¨ˆæ™‚å™¨
    });

    // åˆå§‹é¡¯ç¤º
    document.getElementById('frequencyDisplay').innerText = `è¨­å®šé »ç‡: ${frequency.toFixed(1)} Hz`;

    document.getElementById('volumeSlider').addEventListener('input', function() {
        gainNode.gain.value = parseFloat(this.value);
    });

    // ç¢ºä¿ canvas åœ¨çª—å£èª¿æ•´å¤§å°æ™‚æ›´æ–°
    window.addEventListener('resize', function() {
        const canvas = document.getElementById('oscilloscope');
        canvas.width = window.innerWidth * 0.9; // è¨­ç½® canvas å¯¬åº¦
        canvas.height = 200; // è¨­ç½® canvas é«˜åº¦
    });
</script>

</body>
</html>